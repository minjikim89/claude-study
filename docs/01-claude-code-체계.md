# Claude Code 체계 — 기억 구조와 MD 파일 레벨

## Claude Code의 동작 원리

Claude Code를 처음 접하면 "AI 챗봇"처럼 느껴지지만, 실제로는 **파일 시스템 위에서 동작하는 AI 에이전트**다. 핵심 메커니즘은 단 하나: **컨텍스트 윈도우(200k 토큰)에 텍스트를 주입하는 것**.

Claude Code의 모든 설정 — 규칙, 기억, Skill — 은 결국 마크다운 파일이고, 이 파일들이 적절한 타이밍에 컨텍스트 윈도우에 로드되는 구조다.

## Chat Interface vs CLI — 근본적 차이

claude.ai(웹/앱)에서 대화하던 경험으로 Claude Code에 입문하면, 비슷해 보이지만 동작 방식이 근본적으로 다르다는 점을 먼저 이해해야 한다.

### Chat Interface (claude.ai 웹/앱)

- **브라우저나 앱**에서 대화창에 텍스트를 입력
- 대화 내용은 **Anthropic 클라우드 서버**에 저장
- 웹에서 시작한 대화를 모바일 앱에서 이어볼 수 있음 (같은 계정이면 동기화)
- AI가 할 수 있는 일: 텍스트 생성, 분석, 요약 등 **대화 안에서의 작업**
- 내 컴퓨터의 파일에는 접근 불가

### CLI (Claude Code)

- **터미널**에서 `claude` 명령어로 실행
- 대화 내용은 **내 컴퓨터(로컬)**에만 존재
- 세션을 종료하면 대화 컨텍스트는 소멸 (영구 저장은 CLAUDE.md, Memory로 별도 처리)
- AI가 할 수 있는 일: 파일 읽기/쓰기, 터미널 명령 실행, Git 조작 등 **컴퓨터 전체를 조작**
- 내 프로젝트 폴더 안에서 직접 작업

### 한눈에 비교

| 구분 | Chat (claude.ai) | CLI (Claude Code) |
|------|-------------------|-------------------|
| 실행 환경 | 브라우저 / 모바일 앱 | 터미널 (macOS, Linux) |
| 대화 저장 | 클라우드 (계정 동기화) | 로컬 (세션 단위, 동기화 없음) |
| 파일 접근 | 불가 (업로드한 파일만) | 전체 파일시스템 접근 가능 |
| 코드 실행 | 불가 | Bash, Python 등 직접 실행 |
| 외부 도구 연동 | 제한적 | MCP로 Slack, Notion, DB 등 연결 |
| 비유 | 카카오톡으로 비서에게 질문 | 비서가 내 사무실에 와서 직접 작업 |

**핵심**: 같은 Claude 모델(Opus, Sonnet 등)을 사용하지만, **접근할 수 있는 범위**가 완전히 다르다. Chat은 "대화 안"에 갇혀 있고, CLI는 "컴퓨터 전체"를 작업 공간으로 쓴다.

## Chat과 CLI는 연결되지 않는다

Chat Interface에서 나눈 대화와 CLI에서 나눈 대화는 **완전히 별개**다.

```
claude.ai (웹/앱)  ←→  동기화 O  (같은 계정이면 대화 이어짐)
        ↕
       연결 X  ← 대화 히스토리, 설정, 컨텍스트 모두 공유 불가
        ↕
Claude Code (CLI)  →  로컬 세션 단위, 종료 시 컨텍스트 소멸
```

| 구분 | Chat → CLI | CLI → Chat |
|------|-----------|-----------|
| 대화 이어가기 | 불가 | 불가 |
| 설정 공유 | 불가 (Projects ≠ CLAUDE.md) | 불가 |
| 파일 공유 | 불가 | 불가 |

### 왜 분리되어 있는가?

Claude Code는 **로컬 파일시스템 위에서 동작하는 에이전트**이기 때문이다. 대화 자체가 파일 읽기/쓰기, 터미널 실행 등 로컬 환경과 밀접하게 결합되어 있어서, 클라우드 기반인 claude.ai와 대화를 공유하는 것이 구조적으로 어렵다.

### 노코드 도구 비교

| 노코드 도구 | 동기화 방식 | Claude 생태계 |
|---|---|---|
| Notion 웹 ↔ Notion 앱 | 완전 동기화 | claude.ai 웹 ↔ 앱: 동기화 O |
| Notion ↔ Zapier | API로 연결 (별개 제품) | claude.ai ↔ Claude Code: 연결 X |
| Cursor ↔ ChatGPT | 완전 별개 제품 | 이것과 유사한 관계 |

**정리**: claude.ai와 Claude Code를 Notion 웹/앱처럼 "같은 도구의 다른 접점"으로 생각하면 안 된다. 오히려 **Notion과 Zapier**처럼 "같은 회사가 아니라 별개 제품"에 가깝다. 뒤에서 같은 AI 모델을 쓸 뿐, 인터페이스·저장소·기능이 모두 다르다.

## 컨텍스트 윈도우 구조

```
┌─────────────────────────────────────────────────────────┐
│                    컨텍스트 윈도우 (200k 토큰)             │
│                                                          │
│  ┌──────────────┐                                        │
│  │ CLAUDE.md    │ ← 항상 자동 로드. 세션 시작과 동시에 주입  │
│  │ (전역 규칙)   │                                        │
│  └──────────────┘                                        │
│                                                          │
│  ┌──────────────┐                                        │
│  │ Auto Memory  │ ← 항상 자동 로드. MEMORY.md 내용 주입    │
│  │ (학습 기록)   │                                        │
│  └──────────────┘                                        │
│                                                          │
│  ┌──────────────┐                                        │
│  │ Skill A      │ ← "/명령어" 입력할 때만 로드             │
│  │ (레시피)      │                                        │
│  └──────────────┘                                        │
│                                                          │
│  ┌──────────────┐                                        │
│  │ 대화 내용     │ ← 사용자와 Claude의 주고받은 메시지들     │
│  └──────────────┘                                        │
└─────────────────────────────────────────────────────────┘
```

200k 토큰은 무한하지 않다. 그래서 **항상 필요한 것은 자동 로드**, **가끔 필요한 것은 온디맨드 로드**, **일시적인 것은 대화에만 존재**하도록 설계되어 있다.

## CLAUDE.md — 프로젝트의 규칙서

### 3개 레벨 시스템

CLAUDE.md는 적용 범위에 따라 3개 레벨로 존재한다.

```
~/.claude/CLAUDE.md           ← 전역: 모든 프로젝트에 적용 (개인 선호)
./CLAUDE.md                   ← 프로젝트: 이 프로젝트에 적용 (팀 공유)
./CLAUDE.local.md             ← 로컬: 이 프로젝트 + 나만 적용 (git 무시)
```

세 파일이 모두 있으면 **전부 합쳐서** 시스템 프롬프트에 주입된다.

### 각 레벨의 용도와 비유

| 레벨 | 파일 위치 | 적용 범위 | 비유 | 예시 |
|---|---|---|---|---|
| **전역** | `~/.claude/CLAUDE.md` | 내 모든 프로젝트 | 개인 업무 원칙 | "한국어로 답해", "표 형식 선호" |
| **프로젝트** | `./CLAUDE.md` | 이 프로젝트 전체 | 팀 컨벤션 문서 | "테스트 먼저 실행", "커밋 메시지 형식" |
| **로컬** | `./CLAUDE.local.md` | 이 프로젝트 + 나만 | 내 자리 포스트잇 | "디버그 모드 항상 켜기", "특정 경로 무시" |

### 노코드 도구 비교

| 노코드 도구 | Claude Code |
|---|---|
| Notion 워크스페이스 설정 | 전역 CLAUDE.md |
| 프로젝트별 설정 페이지 | 프로젝트 CLAUDE.md |
| 개인 뷰/필터 | CLAUDE.local.md |

### 작성 팁

- **짧게 유지**: 매 세션마다 로드되므로 토큰을 절약해야 함
- **명령형으로 작성**: "한국어로 응답할 것", "테스트를 먼저 실행할 것"
- **구조화**: 헤딩과 리스트로 가독성 확보
- **우선순위 명시**: 충돌 가능성이 있는 규칙은 우선순위를 적어둠

## 세션 시작 시 일어나는 일

Claude Code를 실행하면 다음 순서로 컨텍스트가 구성된다:

```
새 세션 시작
  │
  ▼
┌─ 자동 로드 (매번) ──────────────────────────────┐
│                                                  │
│  1. ~/.claude/CLAUDE.md          (전역 규칙)      │
│  2. ./CLAUDE.md                  (프로젝트 규칙)   │
│  3. ./CLAUDE.local.md            (로컬 규칙)      │
│  4. Auto Memory (MEMORY.md)      (학습 내용)      │
│                                                  │
│  → 전부 합쳐서 시스템 프롬프트에 주입              │
└──────────────────────────────────────────────────┘
  │
  ▼
┌─ 대기 (필요할 때만) ────────────────────────────┐
│                                                  │
│  5. Skills (SKILL.md들)                          │
│     → 목록만 인식, 본문은 호출 시 로드            │
│                                                  │
└──────────────────────────────────────────────────┘
  │
  ▼
  대화 시작
```

**노코드 도구 비유**: 앱을 열면 자동으로 설정이 로드되는 것과 같다. Notion을 열면 워크스페이스 설정 + 개인 설정이 자동 적용되듯이, Claude Code도 세션 시작 시 모든 MD 파일을 읽어들인다.

## 저장 위치 전체 맵

```
~/.claude/
├── CLAUDE.md                          ← 전역 규칙 (모든 프로젝트)
├── settings.json                      ← Claude Code 설정
└── projects/
    └── <프로젝트명>/
        └── memory/
            └── MEMORY.md              ← Auto Memory (프로젝트별 자동 학습)

프로젝트 루트/
├── CLAUDE.md                          ← 프로젝트 규칙 (팀 공유, git 포함)
├── CLAUDE.local.md                    ← 로컬 규칙 (나만, git 무시)
└── .claude/
    ├── skills/
    │   └── my-skill/
    │       └── SKILL.md               ← Skill (호출 시에만 로드)
    └── agents/
        └── my-agent.md                ← 커스텀 Subagent 정의
```

## 핵심 정리

- **Chat(claude.ai)과 CLI(Claude Code)는 별개 제품**: 대화 히스토리, 설정, 파일 모두 공유되지 않음. 같은 AI 모델을 쓰지만 인터페이스와 능력이 완전히 다름
- Claude Code의 모든 설정은 **마크다운 파일 → 컨텍스트 주입** 메커니즘으로 동작
- CLAUDE.md는 3개 레벨(전역/프로젝트/로컬)로 범위를 조절
- 항상 로드되는 것(CLAUDE.md, Memory)과 호출 시 로드되는 것(Skill)을 구분해서 토큰을 효율적으로 사용
- 세션이 시작되면 자동 로드 → 대기 → 대화 순서로 컨텍스트가 구성됨
